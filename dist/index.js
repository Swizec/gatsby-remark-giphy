var e,r=require("unist-util-visit"),t=(e=require("giphy-api"))&&"object"==typeof e&&"default"in e?e.default:e;function n(e){return"giphy-result:"+e}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator"))),module.exports=function(e,o){var i=e.cache,a=e.markdownAST;try{var u=[],c=t({apiKey:o.giphyApiKey,https:!0});return r.visit(a,"image",function(e){var r=e.url;r.startsWith("giphy:")&&u.push(function(){try{var t=r.replace(/^giphy:/,"").replace(/_/g," ");return Promise.resolve(i.get(n(t))).then(function(r){var o=!1;function a(e){if(o)return e}var u=function(){if(!r){var a=function(e,o){try{var a=Promise.resolve(c.search(t)).then(function(e){r=e.data[0],i.set(n(t),r)})}catch(e){return o(e)}return a&&a.then?a.then(void 0,o):a}(0,function(r){r.message="The following error appeared while transforming Giphy for "+t+":\n\n"+r.message,console.error(r),e.type="text",e.value="",o=!0});if(a&&a.then)return a.then(function(){})}}();return u&&u.then?u.then(a):a(u)})}catch(e){return Promise.reject(e)}})}),Promise.resolve(Promise.all(u.map(function(e){return e()}))).then(function(){return a})}catch(e){return Promise.reject(e)}};
//# sourceMappingURL=index.js.map
