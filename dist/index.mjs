import e from"unist-util-visit";import t from"giphy-api";"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));export default function(r,o){var n=r.cache,i=r.markdownAST;try{var a=[],u=t({apiKey:o.giphyApiKey,https:!0});return e(i,"image",function(e){var t=e.url;t.startsWith("giphy:")&&a.push(function(){try{var r=t.replace(/^giphy:/,"");return Promise.resolve(n.get(r)).then(function(t){function i(r){e=o.useVideo?function(e,r){var o="<source src="+t[0].images.looping.mp4+' type="video/mp4" />';return e.type="html",e.children=void 0,e.value='<video style="margin: auto auto; display: block; max-width: 100%" autoplay loop muted playsinline>\n            '+o+"\n        </video>",e}(e):function(e,t){var r=e.url.replace(/^giphy:/,"");return e.alt=r,e.url=t.images.downsized_large.url,e.title=e.title||r,e}(e,t[0])}var a=function(){if(!t)return function(e,o){try{var i=Promise.resolve(u.search(r)).then(function(e){t=e.data,n.set(r,e.data)})}catch(e){return o(e)}return i&&i.then?i.then(void 0,o):i}(0,function(e){throw e.message="The following error appeared while searching Giphy for "+r+":\n\n"+e.message,e})}();return a&&a.then?a.then(i):i()})}catch(e){return Promise.reject(e)}})}),Promise.resolve(Promise.all(a.map(function(e){return e()}))).then(function(){return i})}catch(e){return Promise.reject(e)}}
//# sourceMappingURL=index.mjs.map
