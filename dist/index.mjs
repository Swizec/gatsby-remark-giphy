import r from"unist-util-visit";import t from"giphy-api";"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));export default function(e,n){var o=e.cache,i=e.markdownAST;try{var a=[],u=t({apiKey:n.giphyApiKey,https:!0});return r(i,"image",function(r){var t=r.url;t.startsWith("giphy:")&&a.push(function(){try{var e=t.replace(/^giphy:/,"");return Promise.resolve(o.get(e)).then(function(t){function n(n){r.url=t[0].images.downsized_large.url,r.alt=e,r.title=r.title||e}var i=function(){if(!t)return function(r,n){try{var i=Promise.resolve(u.search(e)).then(function(r){t=r.data,o.set(e,r.data)})}catch(r){return n(r)}return i&&i.then?i.then(void 0,n):i}(0,function(r){throw r.message="The following error appeared while searching Giphy for "+e+":\n\n"+r.message,r})}();return i&&i.then?i.then(n):n()})}catch(r){return Promise.reject(r)}})}),Promise.resolve(Promise.all(a.map(function(r){return r()}))).then(function(){return i})}catch(r){return Promise.reject(r)}}
//# sourceMappingURL=index.mjs.map
