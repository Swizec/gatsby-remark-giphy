{"version":3,"file":"index.mjs","sources":["../src/index.ts"],"sourcesContent":["import visit from \"unist-util-visit\";\nimport giphyClient from \"giphy-api\";\n\ntype PluginOptions = {\n    giphyApiKey: string;\n};\n\nexport default async function (\n    { cache, markdownAST },\n    pluginOptions: PluginOptions\n) {\n    const transformations = [];\n    const giphy = giphyClient({\n        apiKey: pluginOptions.giphyApiKey,\n        https: true,\n    });\n\n    visit(markdownAST, \"image\", (imageNode) => {\n        const url = imageNode.url as string;\n\n        if (url.startsWith(\"giphy:\")) {\n            transformations.push(async () => {\n                const search = url.replace(/^giphy:/, \"\");\n\n                const { data } = await giphy.search(search);\n\n                imageNode.url = data[0].images.downsized_large.url;\n            });\n        }\n    });\n\n    await Promise.all(transformations.map((t) => t()));\n\n    return markdownAST;\n}\n"],"names":["pluginOptions","transformations","giphy","giphyClient","apiKey","giphyApiKey","https","visit","markdownAST","imageNode","url","startsWith","push","search","replace","images","downsized_large","Promise","all","map","t"],"mappings":"mFASIA,+BAEMC,EAAkB,GAClBC,EAAQC,EAAY,CACtBC,OAAQJ,EAAcK,YACtBC,OAAO,WAGXC,EAAMC,EAAa,iBAAUC,OACnBC,EAAMD,EAAUC,IAElBA,EAAIC,WAAW,WACfV,EAAgBW,wBACNC,EAASH,EAAII,QAAQ,UAAW,2BAEfZ,EAAMW,OAAOA,qBAEpCJ,EAAUC,WAAW,GAAGK,OAAOC,gBAAgBN,6DAKrDO,QAAQC,IAAIjB,EAAgBkB,aAAKC,UAAMA,+BAEtCZ"}