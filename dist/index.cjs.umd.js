!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("unist-util-visit"),require("giphy-api")):"function"==typeof define&&define.amd?define(["unist-util-visit","giphy-api"],t):e.gatsbyRemarkGiphy=t(e.unistUtilVisit,e.giphyClient)}(this,function(e,t){function r(e){return"giphy-result:"+e}return t=t&&t.hasOwnProperty("default")?t.default:t,"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator"))),function(n,i){var o=n.cache,a=n.markdownAST;try{var u=[],l=t({apiKey:i.giphyApiKey,https:!0});return e.visit(a,"image",function(e){var t=e.url;t.startsWith("giphy:")&&u.push(function(){try{var n=t.replace(/^giphy:/,"").replace(/_/g," ");return Promise.resolve(o.get(r(n))).then(function(t){var i=!1;function a(r){if(i)return r;try{e=function(e,t){var r=e.url.replace(/^giphy:/,"");return e.alt=r,e.url=t.images.downsized_large.url,e.title=e.title||r,e}(e,t)}catch(t){console.warn("Couldn't find giphy for: "+n),e.type="text",e.value=""}}var u=function(){if(!t){var a=function(e,i){try{var a=Promise.resolve(l.search(n)).then(function(e){t=e.data[0],o.set(r(n),t)})}catch(e){return i(e)}return a&&a.then?a.then(void 0,i):a}(0,function(t){t.message="The following error appeared while transforming Giphy for "+n+":\n\n"+t.message,console.error(t),e.type="text",e.value="",i=!0});if(a&&a.then)return a.then(function(){})}}();return u&&u.then?u.then(a):a(u)})}catch(e){return Promise.reject(e)}})}),Promise.resolve(Promise.all(u.map(function(e){return e()}))).then(function(){return a})}catch(e){return Promise.reject(e)}}});
//# sourceMappingURL=index.cjs.umd.js.map
