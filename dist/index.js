function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=e(require("unist-util-visit")),r=e(require("giphy-api"));function i(e){return"giphy-result:"+e}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator"))),module.exports=function(e,n){var o=e.cache,a=e.markdownAST;try{var l=[],u=r({apiKey:n.giphyApiKey,https:!0}),s=n.embedWidth||"100%";return t(a,"image",function(e){var t=e.url;t.startsWith("giphy:")&&l.push(function(){try{var r=t.replace(/^giphy:/,"").replace(/_/g," ");return Promise.resolve(o.get(i(r))).then(function(t){var a=!1;function l(i){if(a)return i;try{e=n.useIframe?function(e,t,r){var i=Math.round(Number(t.images.original.height)/Number(t.images.original.width)*Number(r.replace("%","")));return e.type="html",e.children=void 0,e.value='<div style="width:'+r+";height:0;padding-bottom:"+i+'%;position:relative;margin: 0 auto"><iframe src="'+t.embed_url+'" width="100%" height="100%" style="position:absolute" frameborder="0" class="giphy-embed" allowfullscreen loading="lazy"></iframe></div>',e}(e,t,s):n.useVideo?function(e,r,i){var n="<source src="+t.images.looping.mp4+' type="video/mp4" />';return e.type="html",e.children=void 0,e.value='<video style="margin: auto auto; display: block; max-width: '+i+'" autoplay loop muted playsinline loading="lazy">\n            '+n+"\n        </video>",e}(e,0,s):function(e,t){var r=e.url.replace(/^giphy:/,"");return e.alt=r,e.url=t.images.downsized_large.url,e.title=e.title||r,e}(e,t)}catch(t){console.warn("Couldn't find giphy for: "+r),e.type="text",e.value=""}}var c=function(){if(!t){var n=function(e,n){try{var a=Promise.resolve(u.search(r)).then(function(e){t=e.data[0],o.set(i(r),t)})}catch(e){return n(e)}return a&&a.then?a.then(void 0,n):a}(0,function(t){t.message="The following error appeared while transforming Giphy for "+r+":\n\n"+t.message,console.error(t),e.type="text",e.value="",a=!0});if(n&&n.then)return n.then(function(){})}}();return c&&c.then?c.then(l):l(c)})}catch(e){return Promise.reject(e)}})}),Promise.resolve(Promise.all(l.map(function(e){return e()}))).then(function(){return a})}catch(e){return Promise.reject(e)}};
//# sourceMappingURL=index.js.map
